<div class="container mb-12" ngxDroppable [model]="value">

    <mat-card *ngFor="let item of value" class="m-8 item" ngxDraggable [model]="item" [fxFlex]="uiElement.width"
        [style.background]="uiElement.background">

        <mat-card-header>
            <mat-card-title-group>
                <mat-card-title>
                    <strong>
                        <ng-container *ngIf="uiElement.titleLink">
                            <a (click)="run(uiElement.titleLink, item)" class="link">
                                {{item[uiElement.titleKey]}}
                            </a>
                        </ng-container>
                        <ng-container *ngIf="!uiElement.titleLink">
                            {{item[uiElement.titleKey]}}
                        </ng-container>
                    </strong>
                </mat-card-title>
                <mat-card-subtitle>{{item[uiElement.descriptionKey]}}</mat-card-subtitle>
            </mat-card-title-group>
            <div fxFlex></div>
            <button mat-icon-button [matMenuTriggerFor]="widgetMenu" aria-label="more" *ngIf="uiElement.workflow && uiElement.workflow.length > 0">
                <mat-icon>more_vert</mat-icon>
            </button>
            <mat-menu #widgetMenu="matMenu" [overlapTrigger]="false" *ngIf="uiElement.workflow && uiElement.workflow.length > 0">

                <ng-container *ngFor="let workflow of uiElement.workflow">

                    <mat-divider *ngIf="workflow.divider"></mat-divider>

                    <button mat-menu-item *ngIf="! workflow.divider" (click)="run(workflow.script, item)">
                        <span>{{workflow.label}}</span>
                    </button>

                </ng-container>

            </mat-menu>

        </mat-card-header>

        <mat-card-content>

            <div *ngFor="let content of uiElement.content">

                <ng-container *ngIf="content.type == 'text'">{{format(item[content.key], content.transform)}}</ng-container>
                <simple-table *ngIf="content.type == 'simple-table'" [uiElement]="content" [data]="item"></simple-table>
                <script-button *ngIf="content.type == 'action-buttons'" [uiElement]="{ 'buttons': item[content.key] }" [data]="item"></script-button>

            </div>

        </mat-card-content>

    </mat-card>
</div>