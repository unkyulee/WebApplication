{
  "_id": "200000000000000000000013",
  "name": "Core Company - Feature",
  "type": "layout",
  "contentStyle": {
    "display": "flex",
    "flexDirection": "column",
    "flexGrow": 1,
    "height": "100%",
    "width": "100%",
    "overflow-y": "auto",
    "overflow-x": "hidden"
  },
  "layoutStyle": {
    "display": "flex",
    "flexDirection": "column",
    "flexGrow": 1,
    "padding": "16px"
  },
  "screens": [
    {
      "type": "selection",
      "selectionType": "autocomplete",
      "key": "_params_.feature",
      "label": "Add a feature",
      "src": "`/api/admin/core.feature?_sort=name&size=100&name=${this._value?this._value:''}`",
      "transform": "response.data",
      "optionLabelTransform": "`${option.name}`",
      "inputValueTransform": "obj.get(this._value, 'name', typeof this._value == 'object'?'':this._value)",
      "selected": "obj.ensureExists(this.data, 'features', []); \r\nlet feature = this.uiElement.options.find(x => x == this._value); \r\nthis.data.features.push(feature.key); \r\nsetTimeout(() => this.value = '');\r\n\r\nthis.event.send({name: 'save'})",
      "layoutStyle": {
        "width": "100%"
      },
      "style": {
        "width": "100%"
      }
    },
    {
      "type": "data-table",
      "key": "features",
      "tableType": "list",
      "condition": "this.data.features",
      "cdkDragDisabled": "this.config.isHandset || typeof this.config.isHandset == 'undefined'",
      "drop": "if(event.container == event.previousContainer) {\r\n    let items = obj.get(this.data, 'features', [])\r\n    if(items.length > event.currentIndex && items.length > event.previousIndex) {\r\n        let movedItem = items[event.previousIndex]\r\n        let remainingItems = items.filter((item, index) => index !== event.previousIndex);\r\n        \r\n        this.data.features = [\r\n            ...remainingItems.slice(0, event.currentIndex),\r\n            movedItem,\r\n            ...remainingItems.slice(event.currentIndex)\r\n        ]\r\n    }\r\n}",
      "layoutStyle": {
        "flex-grow": 1,
        "display": "flex",
        "flex-direction": "column",
        "marginTop": "-12px",
        "marginBottom": "12px",
        "width": "100%"
      },
      "itemBoxStyle": {
        "background": "aliceblue",
        "margin": "4px",
        "padding": "4px",
        "cursor": "pointer"
      },
      "itemBoxClass": {
        "mat-elevation-z1": true
      },
      "click": "this.event.send({name: 'open-sheet', uiElementId: '788688320000000000000130', data: {engineer: item, appointment: this.data}})",
      "columns": [
        {
          "type": "layout",
          "layoutStyle": {
            "display": "flex",
            "flexFlow": "row wrap"
          },
          "screens": [
            {
              "type": "typography",
              "format": "this.data",
              "style": {
                "padding": "8px"
              }
            },
            {
              "type": "layout",
              "layoutStyle": {
                "width": "1px",
                "flexGrow": 1
              }
            },
            {
              "type": "button",
              "buttonType": "mat-icon-button",
              "icon": "clear",
              "click": "if (confirm(`Cancello ${this.data}?`)) {\r\n    this.event.send({ \r\n        name: 'delete-data', \r\n        path: 'features', \r\n        data: this.data \r\n    })\r\n}\r\n"
            }
          ]
        }
      ]
    }
  ]
}